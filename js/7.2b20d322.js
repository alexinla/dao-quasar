(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[7],{"367d":function(t,e,n){"use strict";var o=n("c05d"),s=n.n(o);s.a},"39ce":function(t,e,n){},6426:function(t,e,n){},7365:function(t,e,n){"use strict";var o=n("39ce"),s=n.n(o);s.a},"995d":function(t,e,n){"use strict";n.r(e);var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("q-layout",{staticClass:"page",attrs:{view:"hHh lpR fFf"}},[n("q-page-container",[n("div",{staticClass:"header"},[n("HeaderBarLeft"),n("HeaderBarRight",{staticClass:"right"})],1),n("div",{key:t.$route.params.id,staticClass:"body"},[n("BodyLeft",{on:{getGroupInfo:t.setGroupInfo}}),null!==t.groupInfo?n("BodyRight",{attrs:{groupInfo:t.groupInfo}}):t._e()],1)])],1)},s=[],r=n("de22"),a=n("3b4c"),i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"container"},[t.isReady?n("Article",{staticClass:"article",attrs:{viewType:"article",post:t.post,groupCreatorId:t.groupCreatorId,addComment:t.showAddComment},on:{edit:t.afterEdit,del:t.afterDelete}}):t._e(),t.isReady?n("Comments",{staticClass:"comments",attrs:{comments:t.comments}}):t._e(),t.isReady?n("AddComment",{attrs:{targetPost:t.post,onSave:t.onAddComment},model:{value:t.shouldShowAddComment,callback:function(e){t.shouldShowAddComment=e},expression:"shouldShowAddComment"}}):n("div",{staticClass:"spinner"},[n("q-spinner",{attrs:{color:"primary",size:"3em"}})],1)],1)},c=[],u=(n("8e6e"),n("8a81"),n("456d"),n("a481"),n("f751"),n("c47a")),p=n.n(u),d=n("f3e3"),l=n.n(d),f=(n("551c"),n("ac6a"),n("cadf"),n("06db"),n("5df3"),n("b95e")),m=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("div",{staticClass:"header",attrs:{"data-is-empty":0===t.postLikeComments.length}},[t._v(t._s(t.comments.length)+"条评论")]),t._l(t.postLikeComments,(function(t){return n("div",{key:t.comment.id,staticClass:"body"},[n("Article",{attrs:{viewType:"comment",post:t}})],1)}))],2)},v=[];function g(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function h(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?g(Object(n),!0).forEach((function(e){p()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var b={components:{Article:f["a"]},props:{comments:{type:Array,required:!0}},computed:{postLikeComments:function(){return this.comments.map((function(t){return h({},t,{post:t.comment})}))}}},_=b,C=(n("e052"),n("2877")),y=Object(C["a"])(_,m,v,!1,null,"051a8b33",null),O=y.exports,I=n("97af"),j=n("e019");function w(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function k(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?w(Object(n),!0).forEach((function(e){p()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):w(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var A=function(t){var e=t.postId,n=t.isLoggedIn;return n?Promise.all([Object(I["b"])("/protected/post/info",{post_id:e}),Object(I["b"])("/protected/post/likes",{posts:[e]})]).then((function(t){var n=l()(t,2),o=n[0].post,s=n[1].likes;return o.likeStatus=void 0===s[e]?1:s[e],o})):Object(I["b"])("/post/info",{post_id:e}).then((function(t){return k({},t.post,{likeStatus:1})}))},P=function(t){return Object(I["a"])("/grp/".concat(t)).then((function(t){return t.grp}))},L=function(t){return Object(I["a"])("/comments/".concat(t)).then((function(t){return t.comments}))},S={components:{Article:f["a"],Comments:O,AddComment:j["a"]},data:function(){return{post:null,groupInfo:null,comments:[],isReady:!1,shouldShowAddComment:!1}},computed:{isLoggedIn:function(){return""!==this.$store.state.user.userid},postId:function(){return+this.$route.params.id},groupCreatorId:function(){return this.groupInfo.creator}},methods:{showAddComment:function(){this.shouldShowAddComment=!0},onAddComment:function(){var t=this;L(this.postId).then((function(e){t.comments=e,t.post.post.num_comment=e.length}))},afterEdit:function(t){Object.assign(this.post.post,t)},afterDelete:function(){this.$router.replace("/group/".concat(this.groupInfo.id))}},mounted:function(){var t=this,e=this.isLoggedIn,n=this.postId;Promise.all([A({postId:n,isLoggedIn:e}),L(n)]).then((function(e){var n=l()(e,2),o=n[0],s=n[1];return t.post=o,t.comments=s,P(o.post.grp)})).then((function(e){t.groupInfo=e,t.isReady=!0,t.$emit("getGroupInfo",e)})).catch((function(e){t.$q.notify(e.message)}))}},R=S,$=(n("367d"),n("eebe")),D=n.n($),x=n("0d59"),B=Object(C["a"])(R,i,c,!1,null,"18779fdd",null),E=B.exports;D()(B,"components",{QSpinner:x["a"]});var q=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"container"},[t.isReady?n("div",{staticClass:"info"},[n("router-link",{staticClass:"link",attrs:{to:t.groupLink}},[n("q-avatar",{staticClass:"avatar",attrs:{rounded:"",size:"65px"}},[n("img",{attrs:{src:t.groupInfo.avatar||"statics/group.svg"}})]),n("div",{staticClass:"name"},[t._v(t._s(t.groupInfo.name))])],1),n("div",{staticClass:"popup"},[n("div",{staticClass:"popup_body"},[n("div",{staticClass:"popup_data"},[n("div",{staticClass:"popup_data_label"},[t._v("小组成员")]),n("div",{staticClass:"popup_data_value"},[t._v(t._s(t.groupInfo.num_member))])]),n("div",{staticClass:"popup_data"},[n("div",{staticClass:"popup_data_label"},[t._v("小组文章")]),n("div",{staticClass:"popup_data_value"},[t._v(t._s(t.groupInfo.num_post))])]),t._m(0)]),n("div",{staticClass:"popup_actions"},[t.isJoined?t._e():n("JoinGroupBtn",{attrs:{groupInfo:t.groupInfo}}),n("AddArticleBtn",{attrs:{groupId:t.groupId,onSave:t.onAddArticle}})],1)])],1):t._e(),t.isReady?n("div",{staticClass:"postList"},[n("div",{staticClass:"postList_header"},[t._v("相关内容")]),n("div",{staticClass:"postList_body"},t._l(t.topPosts,(function(e){return n("router-link",{key:e.post.id,staticClass:"post",attrs:{to:"/articles/"+e.post.id}},[n("q-avatar",{staticClass:"post_avatar",attrs:{rounded:"",size:"50px"}},[n("img",{attrs:{src:e.creator.avatar||"statics/user.svg"}})]),n("div",{staticClass:"post_title",attrs:{title:e.post.content}},[t._v(t._s(e.post.content))]),n("div",{staticClass:"post_num"},[t._v(t._s(e.post.num_like)+"赞")]),n("div",{staticClass:"post_time"},[t._v(t._s(t.formatDate(e.post.create_at)))])],1)})),1)]):n("div",{staticClass:"spinner"},[n("q-spinner",{attrs:{color:"primary",size:"3em"}})],1)])},J=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"popup_data"},[n("div",{staticClass:"popup_data_label"},[t._v("发帖奖励(单位)")]),n("div",{staticClass:"popup_data_value"},[t._v("1000")])])}],G=n("967e"),H=n.n(G),Q=(n("96cf"),n("fa84")),z=n.n(Q),T=n("bea7"),F=n("cbd7"),K=function(t,e){return e?Object(I["b"])("/protected/post/top",{grp:t}).then((function(t){return t.posts})):Object(I["b"])("/post/top",{grp:t}).then((function(t){return t.posts}))},M=function(t){return Object(I["a"])("/protected/grp/joined").then((function(e){return e.grps_joined.some((function(e){return e.grp.id===t}))}))},N={components:{AddArticleBtn:T["a"],JoinGroupBtn:F["a"]},props:{groupInfo:{type:Object,required:!0}},data:function(){return{isReady:!1,isJoined:!1,topPosts:[]}},computed:{groupId:function(){return this.groupInfo.id},groupLink:function(){return"/group/".concat(this.groupId)},isLoggedIn:function(){return""!==this.$store.state.user.userid}},methods:{formatDate:function(t){return this.$utils.timeStringToLocal(t,"RelativeDay")},onAddArticle:function(){this.$router.push(this.groupLink)}},mounted:function(){var t=z()(H.a.mark((function t(){return H.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,K(this.groupId,this.isLoggedIn);case 3:if(this.topPosts=t.sent,!this.isLoggedIn){t.next=8;break}return t.next=7,M(this.groupInfo.id);case 7:this.isJoined=t.sent;case 8:this.isReady=!0,t.next=14;break;case 11:t.prev=11,t.t0=t["catch"](0),this.$q.notify(t.t0.message);case 14:case"end":return t.stop()}}),t,this,[[0,11]])})));function e(){return t.apply(this,arguments)}return e}()},U=N,V=(n("a2e2"),n("cb32")),W=Object(C["a"])(U,q,J,!1,null,"62a1a479",null),X=W.exports;D()(W,"components",{QAvatar:V["a"],QSpinner:x["a"]});var Y={components:{HeaderBarLeft:r["a"],HeaderBarRight:a["a"],BodyLeft:E,BodyRight:X},data:function(){return{groupInfo:null}},methods:{setGroupInfo:function(t){this.groupInfo=t}}},Z=Y,tt=(n("7365"),n("4d5a")),et=n("09e3"),nt=Object(C["a"])(Z,o,s,!1,null,"f23ff480",null);e["default"]=nt.exports;D()(nt,"components",{QLayout:tt["a"],QPageContainer:et["a"]})},a2e2:function(t,e,n){"use strict";var o=n("6426"),s=n.n(o);s.a},c05d:function(t,e,n){},e052:function(t,e,n){"use strict";var o=n("fd90"),s=n.n(o);s.a},fd90:function(t,e,n){}}]);