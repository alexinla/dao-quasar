(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[0],{"13ac":function(t,e,n){},"27cf":function(t,e,n){"use strict";var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("q-dialog",{model:{value:t.shouldShow,callback:function(e){t.shouldShow=e},expression:"shouldShow"}},[n("q-card",{staticClass:"q-pa-lg",staticStyle:{width:"440px"}},[n("q-card-section",{staticClass:"row items-center q-pb-none"},[n("div",{staticClass:"text-h6"},[t._v(t._s(t.title))]),n("q-space"),n("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{icon:"close",flat:"",round:"",dense:""}})],1),n("q-card-section",{staticClass:"q-pt-none"},[t._v(t._s(t.content))]),t.showInfo?t._e():n("q-card-actions",{staticClass:"bg-white text-teal",attrs:{align:"center"}},[n("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],staticClass:"btn-sumit q-mr-lg",attrs:{outline:"",color:"primary",label:"取消"},on:{click:t.cancel}}),n("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],staticClass:"btn-sumit",attrs:{unelevated:"",color:"primary",label:"确定"},on:{click:t.comfirm}})],1),t.showInfo?n("q-card-actions",{staticClass:"bg-white text-teal",attrs:{align:"center"}},[n("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],staticClass:"q-px-xl",attrs:{unelevated:"",color:"primary",label:"查看详情"},on:{click:t.comfirm}})],1):t._e()],1)],1)],1)},i=[],a={components:{},props:{title:{type:String,default:"弹框默认标题"},content:{type:String,default:"弹框默认备注"},showInfo:{type:Boolean,default:!1},value:Boolean},data:function(){return{show:!1,small:""}},watch:{},computed:{shouldShow:{get:function(){return this.value},set:function(t){this.$emit("input",t)}}},methods:{comfirm:function(){this.$emit("taost_confirm")},cancel:function(){this.$emit("taost_cancel")}},created:function(){},mounted:function(){}},r=a,s=(n("7720"),n("2877")),c=n("eebe"),l=n.n(c),u=n("24e8"),d=n("f09f"),p=n("a370"),h=n("2c91"),f=n("9c40"),m=n("4b7e"),v=n("7f67"),g=Object(s["a"])(r,o,i,!1,null,"5df879f2",null);e["a"]=g.exports;l()(g,"components",{QDialog:u["a"],QCard:d["a"],QCardSection:p["a"],QSpace:h["a"],QBtn:f["a"],QCardActions:m["a"]}),l()(g,"directives",{ClosePopup:v["a"]})},"2ba9":function(t,e,n){},"304d":function(t,e,n){"use strict";var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("ToastComponent",{attrs:{title:t.title,content:t.content},on:{taost_cancel:t.taost_cancel,taost_confirm:t.taost_confirm},model:{value:t.shouldShow,callback:function(e){t.shouldShow=e},expression:"shouldShow"}})},i=[],a=n("967e"),r=n.n(a),s=(n("96cf"),n("fa84")),c=n.n(s),l=(n("c5f6"),n("27cf")),u={components:{ToastComponent:l["a"]},props:{value:Boolean,groupId:Number},data:function(){return{title:"真的要退出小组？",content:""}},watch:{},computed:{shouldShow:{get:function(){return this.value},set:function(t){this.$emit("input",t)}}},methods:{taost_cancel:function(){this.$q.notify("已取消")},taost_confirm:function(){var t=this;return c()(r.a.mark((function e(){var n,o,i;return r.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n="/protected/grp/detach",o={grp:t.groupId},e.next=4,t.$axios.post(n,o);case 4:i=e.sent,0===i.data.code?(t.$q.notify({message:"已退出本群。"}),t.$router.go(0)):104===i.data.code&&(t.$q.notify({message:"认证失效，请重新登录"}),t.$showLogin());case 6:case"end":return e.stop()}}),e)})))()}},created:function(){},mounted:function(){}},d=u,p=n("2877"),h=Object(p["a"])(d,o,i,!1,null,null,null);e["a"]=h.exports},"3b4c":function(t,e,n){"use strict";var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"header-bar-right"},[t.isLoggedIn?n("div",[n("q-avatar",{staticClass:"header-notify",attrs:{size:"36px",icon:"notifications_none"},on:{click:t.readNotify}},[t.unreadNotify.length?n("q-badge",{attrs:{color:"red",floating:""}},[t._v(t._s(t.unreadNotify.length))]):t._e()],1),n("q-avatar",{staticClass:"header-avatar hoverable-avatar",attrs:{size:"30px"}},[n("img",{attrs:{src:t.$store.state.user.avatar||"statics/user.svg"}}),n("q-menu",[n("q-list",{staticStyle:{"min-width":"100px"}},[n("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{clickable:""}},[n("q-item-section",{on:{click:t.createGrp}},[t._v("新建一个群")])],1),t.isInGroupPath?n("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{clickable:""}},[n("q-item-section",{on:{click:function(e){return t.setGroupToTop()}}},[t._v(t._s(2===t.currentGroup.pinned?"取消置顶本群":"置顶本群"))])],1):t._e(),t.isInGroupPath?n("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{clickable:""}},[n("q-item-section",{on:{click:function(e){return t.leaveGroup()}}},[t._v("退出本群")])],1):t._e(),n("q-separator"),n("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{clickable:""}},[n("q-item-section",{on:{click:function(e){return t.$router.push("/person/show/"+t.$store.state.user.userid)}}},[t._v("我的DAO @"+t._s(t.user.userid))])],1),n("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{clickable:""}},[n("q-item-section",{on:{click:t.clearLogin}},[t._v("退出登录 ("+t._s(t.user.name)+")")])],1)],1)],1)],1),n("q-dialog",{attrs:{"content-class":"notify-dialog","transition-show":"fade","transition-hide":"fade",seamless:"",position:"top"},on:{hide:t.hideNotice},model:{value:t.showNotice,callback:function(e){t.showNotice=e},expression:"showNotice"}},[n("q-card",[n("q-card-section",[0===t.unreadNotify.length?n("div",[t._v("当前无未读通知。")]):t._e(),t._l(t.unreadNotify,(function(e){return n("div",{key:e.id,staticClass:"header-notify-detail"},[t._v("\n            "+t._s(e.h_text)+"\n            "),n("q-separator")],1)}))],2)],1)],1)],1):n("q-btn",{directives:[{name:"require-login-click",rawName:"v-require-login-click"}],attrs:{color:"primary",flat:"",label:"快速登录"}}),n("groupCreate",{model:{value:t.showCreate,callback:function(e){t.showCreate=e},expression:"showCreate"}}),n("quitGroup",{attrs:{groupId:t.quitGroupId},model:{value:t.showQuitGroup,callback:function(e){t.showQuitGroup=e},expression:"showQuitGroup"}})],1)},i=[],a=n("4db1"),r=n.n(a),s=n("967e"),c=n.n(s),l=(n("96cf"),n("fa84")),u=n.n(l),d=n("f8c8"),p=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("q-dialog",{model:{value:t.shouldShow,callback:function(e){t.shouldShow=e},expression:"shouldShow"}},[n("q-card",{staticClass:"q-pa-lg",staticStyle:{width:"700px","max-width":"80vw"},attrs:{"full-width":""}},[n("q-card-section",{staticClass:"row items-center q-pb-none"},[n("div",{staticClass:"text-h6"},[t._v("创建一个群")]),n("q-space"),n("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{icon:"close",flat:"",round:"",dense:""}})],1),n("q-card-section",{staticClass:"row items-top"},[n("div",{staticClass:"col q-pa-md"},[n("q-form",{staticClass:"q-gutter-xs"},[n("q-input",{attrs:{label:"群名称","lazy-rules":"",rules:[function(t){return t&&t.length>0||"群名不能为空"}]},model:{value:t.title,callback:function(e){t.title=e},expression:"title"}}),n("q-input",{attrs:{maxlength:"300",placeholder:"描述下你的话题，引起大家的兴趣",type:"textarea",counter:"",rows:"4"},on:{keyup:function(e){if(!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter"))return null;e.stopPropagation()}},model:{value:t.desc_text,callback:function(e){t.desc_text=e},expression:"desc_text"}}),n("q-radio",{attrs:{checked:"",val:"1",label:"任何人"},model:{value:t.read_permission,callback:function(e){t.read_permission=e},expression:"read_permission"}}),n("q-radio",{attrs:{val:"2",label:"仅限组员"},model:{value:t.read_permission,callback:function(e){t.read_permission=e},expression:"read_permission"}}),2==t.read_permission?n("div",[n("q-input",{attrs:{label:"设定密码",type:"password",placeholder:""},model:{value:t.password,callback:function(e){t.password=e},expression:"password"}})],1):t._e()],1)],1),n("div",{staticClass:"col-5 q-pa-md"},[t._v("\n        创建群之后你还可以设置以下参数：入群奖励、阅读奖励、回复奖励等。\n        "),n("br"),n("br"),t._v("请注意，所有的这些奖励的代币将不经过你的确认直接从你的钱包扣掉。\n        若你的钱包余额不够支付奖励，则该群的所有奖励设置将自动归零。\n        "),n("br"),n("br"),t._v("创建群代表你为群内所有言论负责。你若退群，则系统将自动接替你做群主。\n      ")])]),n("q-card-actions",{staticClass:"bg-white text-teal",attrs:{align:"center"}},[n("q-btn",{staticClass:"q-px-xl",attrs:{unelevated:"",color:"primary",label:"完成"},on:{click:t.createGroup}})],1)],1)],1)},h=[],f=(n("7f7f"),n("c5f6"),{components:{},props:{value:Boolean},data:function(){return{title:"",desc_text:"",read_permission:"1",password:""}},watch:{},computed:{shouldShow:{get:function(){return this.value},set:function(t){this.$emit("input",t)}}},methods:{createGroup:function(){var t=this;return u()(c.a.mark((function e(){var n,o,i;return c.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n={name:t.title,desc_text:t.desc_text,read_permission:Number(t.read_permission),password:t.password,avatar:""},""!=n.name&&""!=n.desc_text&&""!=n.read_permission){e.next=5;break}t.$q.notify("信息不完整，请完善信息"),e.next=11;break;case 5:return o="/protected/grp/create",e.next=8,t.$axios.post(o,n);case 8:i=e.sent,0==i.data.code?(t.shouldShow=!1,t.$router.go(0)):t.$q.notify(i.data.message),t.shouldShow=!1;case 11:case"end":return e.stop()}}),e)})))()}},created:function(){},mounted:function(){}}),m=f,v=n("2877"),g=n("eebe"),b=n.n(g),w=n("24e8"),y=n("f09f"),_=n("a370"),k=n("2c91"),x=n("9c40"),q=n("0378"),C=n("27f9"),S=n("3786"),$=n("4b7e"),O=n("7f67"),I=Object(v["a"])(m,p,h,!1,null,null,null),P=I.exports;b()(I,"components",{QDialog:w["a"],QCard:y["a"],QCardSection:_["a"],QSpace:k["a"],QBtn:x["a"],QForm:q["a"],QInput:C["a"],QRadio:S["a"],QCardActions:$["a"]}),b()(I,"directives",{ClosePopup:O["a"]});var j=n("304d"),L={name:"headerBarRight",components:{groupCreate:P,quitGroup:j["a"]},props:{},data:function(){return{showNotice:!1,showCreate:!1,showQuitGroup:!1,notifications:[],quitGroupId:0}},watch:{},computed:{isInGroupPath:function(){return/\/group\//.test(this.$route.fullPath)},unreadNotify:function(){return this.notifications.filter((function(t){return 1===t.read}))},user:function(){return this.$store.state.user},isLoggedIn:function(){return""!==this.$store.state.user.userid},currentGroupId:function(){return this.$store.state.group.currentGroup.id},currentGroup:function(){return this.$store.state.group.currentGroup}},methods:{createGrp:function(){this.showCreate=!0},clearLogin:function(){localStorage.clear(),this.$router.push("/"),this.$store.commit("user/resetUserinfo")},setGroupToTop:function(){var t=this;return u()(c.a.mark((function e(){var n,o,i,a,r;return c.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=t.currentGroup,o=n.pinned,i={grp:n.id,pinned:1===o?2:1},a="/protected/grp/pin",e.next=6,Object(d["b"])(a,i);case 6:r=e.sent,0===r.code&&(1===o?t.$q.notify("置顶成功"):t.$q.notify("取消置顶成功"),t.$router.go(0));case 8:case"end":return e.stop()}}),e)})))()},leaveGroup:function(){this.showQuitGroup=!0,this.quitGroupId=this.currentGroupId},getNotifications:function(){var t=arguments,e=this;return u()(c.a.mark((function n(){var o,i,a,s;return c.a.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return o=t.length>0&&void 0!==t[0]?t[0]:0,i="/protected/user/notifications/"+o,n.next=4,e.$axios.get(i);case 4:a=n.sent,0==a.data.code&&a.data.data.notifications.length&&(s=e.$q.localStorage.getItem("notifications")||[],s.unshift.apply(s,r()(a.data.data.notifications)),e.$q.localStorage.set("notifications",s),e.notifications=s);case 6:case"end":return n.stop()}}),n)})))()},hideNotice:function(){if(!this.showNotice&&this.unreadNotify.length){var t=this.$q.localStorage.getItem("notifications")||[];t.map((function(t){t.read=2})),this.$q.localStorage.set("notifications",t),this.notifications=t}},readNotify:function(){this.showNotice=!this.showNotice}},mounted:function(){if(this.isLoggedIn){var t=this.$q.localStorage.getItem("notifications"),e=0;t&&t.length&&(this.notifications=t,e=t[0].id),this.getNotifications(e)}}},E=L,Q=(n("a4c7"),n("cb32")),N=n("58a8"),B=n("4e73"),D=n("1c1c"),G=n("66e5"),A=n("4074"),T=n("eb85"),z=Object(v["a"])(E,o,i,!1,null,null,null);e["a"]=z.exports;b()(z,"components",{QAvatar:Q["a"],QBadge:N["a"],QMenu:B["a"],QList:D["a"],QItem:G["a"],QItemSection:A["a"],QSeparator:T["a"],QDialog:w["a"],QCard:y["a"],QCardSection:_["a"],QSpace:k["a"],QBtn:x["a"]}),b()(z,"directives",{ClosePopup:O["a"]})},"4cb9":function(t,e,n){},"530c":function(t,e,n){},"61e7":function(t,e,n){"use strict";var o=n("fa79"),i=n.n(o);i.a},"6dcb":function(t,e,n){"use strict";n("28a5"),n("7f7f"),n("34ef"),n("551c"),n("06db");var o=n("bc3a"),i=n.n(o),a=n("97af"),r=function(t){var e=t.file;return new Promise((function(t,n){var o=new FileReader;o.onload=function(o){var r,s,c=o.target.result,l=e.type;r=c.length,s=new Uint8Array(r);for(var u=0;u<r;u++)s[u]=c.charCodeAt(u);var d=new Blob([s],{type:l}),p="/protected/oss/presign",h={key:Date.now()+e.name};Object(a["b"])(p,h).then((function(e){if(e){var o=e.presigned_url,a=e.headers;a["Content-Type"]=l;var r=i.a.create({timeout:3e4,headers:a});r({url:o,method:"put",data:d,processData:!1}).then((function(e){200===e.status?(console.log(o.split("?")[0]),t(o.split("?")[0])):n(new Error("上传失败"))})).catch((function(){n(new Error("上传失败"))}))}else n(new Error("认证失败"))})).catch((function(){n(new Error("认证失败"))}))},o.readAsBinaryString(e)}))};e["a"]=r},"75c1":function(t,e,n){},7720:function(t,e,n){"use strict";var o=n("4cb9"),i=n.n(o);i.a},"78e0":function(t,e,n){"use strict";var o=n("f5da"),i=n.n(o);i.a},"7c54":function(t,e,n){"use strict";var o=n("75c1"),i=n.n(o);i.a},"97af":function(t,e,n){"use strict";n.d(e,"a",(function(){return a})),n.d(e,"b",(function(){return r})),n.d(e,"c",(function(){return s}));n("551c"),n("06db");var o=n("758b"),i=function(t,e,n){return o["a"][t](e,n).then((function(t){return 0===t.data.code?t.data.data:Promise.reject(t.data)}))},a=i.bind(null,"get"),r=i.bind(null,"post"),s=i.bind(null,"put");i.bind(null,"remove")},a3fb:function(t,e,n){},a4c7:function(t,e,n){"use strict";var o=n("13ac"),i=n.n(o);i.a},af08:function(t,e,n){"use strict";var o=n("a3fb"),i=n.n(o);i.a},b95e:function(t,e,n){"use strict";var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{ref:"article",staticClass:"container",attrs:{"data-type":t.viewType}},[n("deleteArticle",{attrs:{postId:t.postId},on:{deleteSuccess:function(e){return t.$emit("del",t.postId)}},model:{value:t.showDeleteArticle,callback:function(e){t.showDeleteArticle=e},expression:"showDeleteArticle"}}),t.canEdit?n("EditArticle",{attrs:{postId:t.postId,initialData:t.post.post,onSave:t.afterEdit},model:{value:t.shouldShowEdit,callback:function(e){t.shouldShowEdit=e},expression:"shouldShowEdit"}}):t._e(),t.post.creator?n("div",{staticClass:"header"},[n("router-link",{attrs:{to:{name:"person",params:{id:t.post.creator.id+""}}}},[n("q-avatar",{directives:[{name:"show",rawName:"v-show",value:!t.personPage,expression:"!personPage"}],staticClass:"hoverable-avatar",attrs:{size:"35px"}},[n("img",{attrs:{src:t.post.creator.avatar||"statics/user.svg"}})])],1),n("router-link",{attrs:{to:{name:"person",params:{id:t.post.creator.id+""}}}},[n("span",{directives:[{name:"show",rawName:"v-show",value:!t.personPage,expression:"!personPage"}],staticClass:"authorName"},[t._v(t._s(t.post.creator.name))])]),n("span",[t._v(t._s(t.$utils.timeStringToLocal(t.post.post.create_at,"RelativeTime")))])],1):t._e(),n("div",{staticClass:"main-body"},["group"===t.viewType?n("router-link",{attrs:{to:{name:"articles",params:{id:t.postId+""}}}},[n("div",{staticClass:"body"},[t._l(t.content_breakLines,(function(e){return n("div",{key:e.id},[t._v(t._s(e||" "))])})),n("div",{directives:[{name:"show",rawName:"v-show",value:t.content_showMore,expression:"content_showMore"}]},[t._v("(点击查看更多...)")])],2)]):n("div",{staticClass:"body"},[t._l(t.content_breakLines,(function(e){return n("div",{key:e.id},[t._v(t._s(e||" "))])})),n("div",{directives:[{name:"show",rawName:"v-show",value:t.content_showMore,expression:"content_showMore"}]},[t._v("(点击查看更多...)")])],2),t.hasVideo?n("div",{staticClass:"video-wraper"},[n("q-media-player",{attrs:{autoplay:!0,muted:!0,type:"video","background-color":"white",radius:"1rem","hide-volume-slider":"",dense:"","show-big-play-button":!0,source:t.post.post.images[0]}})],1):n("ImageGrid",{staticClass:"images",attrs:{images:t.post.post.images}}),n("div",{staticClass:"actions"},[t.shouldShowActions?n("q-btn",{directives:[{name:"require-login-click",rawName:"v-require-login-click"}],class:{isLiked:t.isLiked},attrs:{flat:""},on:{click:t.like}},[n("svg",{class:"svg-icon svg-icon--light-grey svg-icon--hover-middle-grey mr10",attrs:{width:"22",height:"23",viewBox:"0 0 22 23",xmlns:"http://www.w3.org/2000/svg","svg-inline":"",role:"presentation",focusable:"false",tabindex:"-1"}},[n("g",{attrs:{fill:"#E4E4E4","fill-rule":"nonzero"}},[n("path",{attrs:{d:"M20.306 9.02H14.31C16.633.439 12.708 0 12.708 0c-1.664 0-1.319 1.315-1.445 1.535 0 4.197-4.458 7.486-4.458 7.486v11.903c0 1.175 1.601 1.598 2.23 1.598h9.01c.848 0 1.539-2.224 1.539-2.224 2.23-7.58 2.23-9.836 2.23-9.836 0-1.566-1.508-1.441-1.508-1.441zM4.344 9.025H.754c-.743 0-.754.728-.754.728l.742 12.005c0 .764.765.764.765.764h3.108c.648 0 .642-.506.642-.506V9.936c0-.923-.913-.911-.913-.911z"}})])]),n("span",[t._v(t._s(t.post.post.num_like))])]):t._e(),t.shouldShowActions?n("q-btn",{directives:[{name:"require-login-click",rawName:"v-require-login-click"}],attrs:{flat:""},on:{click:t.addComment}},[n("svg",{class:"svg-icon svg-icon--light-grey svg-icon--hover-middle-grey mr10",attrs:{width:"22",height:"20",viewBox:"0 0 22 20",xmlns:"http://www.w3.org/2000/svg","svg-inline":"",role:"presentation",focusable:"false",tabindex:"-1"}},[n("path",{attrs:{d:"M2.753 0A2.792 2.792 0 000 2.849v11.282c0 1.567 1.272 3.007 2.815 3.007H7c.715.775 3.77 2.754 3.77 2.754a.335.335 0 00.493 0s2.195-1.361 3.626-2.754h4.295c1.56 0 2.816-1.44 2.816-3.007V2.833C22.016 1.266 20.775 0 19.264 0H2.753z",fill:"#E4E4E4","fill-rule":"nonzero"}})]),n("span",[t._v(t._s(t.post.post.num_comment))])]):t._e(),t.shouldShowActions?n("q-btn",{directives:[{name:"require-login-click",rawName:"v-require-login-click"}],attrs:{flat:""},on:{click:function(e){return t.share(t.post.post.id)}}},[n("svg",{class:"svg-icon svg-icon--light-grey svg-icon--hover-middle-grey mr10",attrs:{width:"22",height:"18",viewBox:"0 0 22 18",xmlns:"http://www.w3.org/2000/svg","svg-inline":"",role:"presentation",focusable:"false",tabindex:"-1"}},[n("path",{attrs:{d:"M.836 17.942a.98.98 0 01-.83-1.083c.477-4.5 2.06-7.823 4.689-9.895 1.89-1.5 4.288-2.334 7.117-2.489l.585-.031v-3.2c0-1.268 1.152-1.546 1.767-.928l7.178 7.344c.908.928.861 1.886-.046 2.814l-6.993 7.159c-.738.742-1.907.294-1.907-.758v-3.432h-.723c-2.628 0-7.408.526-9.914 4.066-.154.294-.461.449-.784.449-.046-.001-.092-.001-.139-.016z",fill:"#E4E4E4","fill-rule":"nonzero"}})])]):t._e(),t.shouldShowSetting?n("q-btn",{attrs:{flat:""}},[n("svg",{class:"svg-icon svg-icon--light-grey svg-icon--hover-middle-grey mr10",attrs:{width:"20",height:"20",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg","svg-inline":"",role:"presentation",focusable:"false",tabindex:"-1"}},[n("path",{attrs:{d:"M18.547 11.061c-.122-.081-.203-.122-.244-.204a.856.856 0 01-.407-.733V9.31a.91.91 0 01.407-.733.417.417 0 01.244-.204c.652-.366 1.06-1.059 1.019-1.792a9.818 9.818 0 00-1.996-3.3 2.153 2.153 0 00-2.16-.082c-.122.082-.244.082-.326.122-.285.123-.61.123-.855 0l-.774-.407c-.285-.163-.448-.407-.448-.693-.041-.081-.082-.163-.082-.326 0-.774-.448-1.385-1.14-1.71a11.184 11.184 0 00-4.034 0c-.693.325-1.14.977-1.14 1.71 0 .123-.041.245-.082.326 0 .286-.163.57-.448.693l-.774.407c-.286.163-.612.163-.856 0a.65.65 0 01-.326-.122c-.652-.367-1.467-.326-2.118.082C1.11 4.217.458 5.317.01 6.539c-.081.733.326 1.467 1.019 1.833.122.041.204.122.244.204a.856.856 0 01.408.733v.815a.91.91 0 01-.408.733.417.417 0 01-.244.204c-.652.367-1.06 1.06-1.019 1.793a9.819 9.819 0 001.997 3.3c.651.407 1.466.448 2.118.081.122-.081.245-.081.326-.122.285-.122.611-.122.856 0l.774.407c.285.163.448.408.448.693.04.081.081.163.081.326 0 .774.49 1.426 1.141 1.711a10.96 10.96 0 003.993 0c.651-.326 1.14-.978 1.14-1.711 0-.122.041-.245.082-.326 0-.285.163-.57.448-.693l.774-.407c.285-.163.611-.163.856 0a.65.65 0 01.326.122 2.153 2.153 0 002.159-.081c.896-.937 1.548-2.037 1.996-3.26a1.842 1.842 0 00-.978-1.833zm-8.759 1.63c-1.63 0-2.933-1.345-2.933-2.974 0-1.63 1.303-2.974 2.933-2.974s2.933 1.344 2.933 2.974c0 1.63-1.303 2.974-2.933 2.974z",fill:"#E4E4E4","fill-rule":"nonzero"}})]),n("q-menu",{attrs:{"auto-close":""}},[n("q-list",{staticStyle:{"min-width":"100px"}},[t.canPinTop?n("q-item",{attrs:{clickable:""}},[n("q-item-section",{on:{click:function(e){return t.pinTopPost(t.postId)}}},[t._v("置顶")])],1):t._e(),t.canEdit?n("q-item",{attrs:{clickable:""}},[n("q-item-section",{on:{click:t.edit}},[t._v("编辑")])],1):t._e(),n("q-separator"),t.canDelete?n("q-item",{attrs:{clickable:""}},[n("q-item-section",{on:{click:function(e){return t.deletePost(t.postId)}}},[t._v("删除")])],1):t._e()],1)],1)],1):t._e()],1)],1)],1)},i=[],a=n("967e"),r=n.n(a),s=(n("96cf"),n("fa84")),c=n.n(s),l=(n("28a5"),n("c5f6"),n("97af")),u=n("cdde"),d=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("ToastComponent",{attrs:{title:t.title,content:t.content},on:{taost_cancel:t.taost_cancel,taost_confirm:t.taost_confirm},model:{value:t.shouldShow,callback:function(e){t.shouldShow=e},expression:"shouldShow"}})},p=[],h=n("27cf"),f={name:"deleteArticle",components:{ToastComponent:h["a"]},props:{value:Boolean,postId:Number},data:function(){return{title:"确定要删除这个帖子吗？",content:""}},watch:{},computed:{shouldShow:{get:function(){return this.value},set:function(t){this.$emit("input",t)}}},methods:{taost_cancel:function(){this.$q.notify("已取消")},taost_confirm:function(){var t=this;return c()(r.a.mark((function e(){var n,o,i;return r.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n="/protected/post",o={post:t.postId},e.next=4,t.$axios.delete(n,{data:o});case 4:i=e.sent,0==i.data.code?(t.$q.notify("删除成功"),t.$emit("deleteSuccess")):t.$q.notify("删除失败");case 6:case"end":return e.stop()}}),e)})))()}},created:function(){},mounted:function(){}},m=f,v=n("2877"),g=Object(v["a"])(m,d,p,!1,null,null,null),b=g.exports,w=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("Publish",t._b({attrs:{placeholder:"有什么新鲜事告诉大家…",publishBtnLabel:"确认修改",doPublish:t.publish,maxTextLength:5e3},model:{value:t.shouldShow,callback:function(e){t.shouldShow=e},expression:"shouldShow"}},"Publish",t.$attrs,!1))},y=[],_=(n("8e6e"),n("8a81"),n("ac6a"),n("cadf"),n("06db"),n("456d"),n("c47a")),k=n.n(_),x=n("c2ac");function q(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function C(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?q(Object(n),!0).forEach((function(e){k()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):q(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var S=function(t){var e="/protected/post";return Object(l["c"])(e,C({},t,{title:""}))},$={components:{Publish:x["a"]},props:{postId:{type:Number},onSave:{type:Function},value:Boolean},computed:{shouldShow:{get:function(){return this.value},set:function(t){this.$emit("input",t)}}},methods:{publish:function(t){var e=this;return S(C({},t,{id:this.postId})).then((function(){e.onSave&&e.onSave(C({},t,{id:e.postId}))}))}}},O=$,I=Object(v["a"])(O,w,y,!1,null,null,null),P=I.exports,j=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"grid",attrs:{"data-length":t.images.length}},[t._l(t.images,(function(e,o){return n("q-img",{key:o,staticClass:"grid_item cursor-pointer",attrs:{src:e,"spinner-color":"white"},on:{click:function(e){return t.showBigPic(o)}}})})),n("q-dialog",{on:{keyup:[function(e){return e.type.indexOf("key")||37===e.keyCode?t.$refs.carousel.previous():null},function(e){return e.type.indexOf("key")||39===e.keyCode?t.$refs.carousel.next():null}]},model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},[n("q-carousel",{ref:"carousel",staticClass:"slide",attrs:{swipeable:"",animated:"",arrows:"",navigation:"",infinite:""},model:{value:t.slide,callback:function(e){t.slide=e},expression:"slide"}},t._l(t.images,(function(t,e){return n("q-carousel-slide",{key:e,staticStyle:{padding:"0"},attrs:{name:e}},[n("img",{staticClass:"slideImg shadow-12",attrs:{src:t}})])})),1)],1)],2)},L=[],E={props:{images:{required:!0,type:Array}},data:function(){return{slide:0,dialog:!1}},methods:{showBigPic:function(t){this.slide=t,this.dialog=!0}}},Q=E,N=(n("61e7"),n("eebe")),B=n.n(N),D=n("068f"),G=n("24e8"),A=n("880c"),T=n("62cd"),z=Object(v["a"])(Q,j,L,!1,null,"50fcb39e",null),M=z.exports;B()(z,"components",{QImg:D["a"],QDialog:G["a"],QCarousel:A["a"],QCarouselSlide:T["a"]});var J={cancel:1,like:2,dislike:3},U={components:{deleteArticle:b,EditArticle:P,ImageGrid:M},props:{viewType:{type:String,default:"group"},groupCreatorId:Number,post:Object,personPage:{type:Boolean,default:!1},addComment:{type:Function}},data:function(){return{shouldShowEdit:!1,showDeleteArticle:!1}},computed:{content_sub:function(){return"group"===this.viewType?this.post.post.content.substr(0,300):this.post.post.content},content_showMore:function(){return this.post.post.content.length>300&&"group"===this.viewType},content_breakLines:function(){return this.content_sub.split("\n")},canEdit:function(){return this.userid===this.post.post.creator},canDelete:function(){return this.userid===this.post.post.creator||this.userid===this.groupCreatorId},canPinTop:function(){return"comment"!==this.viewType&&this.userid===this.groupCreatorId},shouldShowSetting:function(){return this.canEdit||this.canDelete},shouldShowActions:function(){return"comment"!==this.viewType},isLiked:function(){return this.post.likeStatus===J["like"]},postId:function(){return this.post.post.id},userid:function(){return this.$store.state.user.userid},hasVideo:function(){var t=this.post.post.images,e=[".mp4",".avi",".flv",".mpeg",".wmv",".dat",".asf",".mov",".3gp",".rm",".rmvb",".divx",".dv",".mkv",".qt",".cpk",".fli",".f4v",".m4v",".mod",".swf",".webm"];return!!t.length&&e.some((function(e){return-1!==t[0].indexOf(e)}))}},methods:{edit:function(){this.shouldShowEdit=!0},afterEdit:function(t){this.$emit("edit",t)},onContentClick:function(){"group"===this.viewType&&this.$router.push("/articles/".concat(this.postId))},like:function(){var t=this;return c()(r.a.mark((function e(){var n,o;return r.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:n="/protected/post/like",o={post:t.postId,op:t.isLiked?J["cancel"]:J["like"]},Object(l["b"])(n,o).then((function(){t.post.likeStatus=o.op,o.op===J["like"]?t.post.post.num_like=t.post.post.num_like+1:t.post.post.num_like=t.post.post.num_like-1})).catch((function(e){t.$q.notify(e.message)}));case 3:case"end":return e.stop()}}),e)})))()},share:function(t){var e=this,n="hash"===this.$router.mode?"/#/":"/",o=window.location.protocol+"//"+window.location.host+n+"articles/"+t;Object(u["a"])(o).then((function(){e.$q.notify("帖子地址已复制到剪切板")})).catch((function(){e.$q.notify("浏览器不支持，请手动复制地址")}))},deletePost:function(){var t=this;return c()(r.a.mark((function e(){return r.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.showDeleteArticle=!0;case 1:case"end":return e.stop()}}),e)})))()},pinTopPost:function(){this.$q.notify("置顶功能尚在开发")}},created:function(){},mounted:function(){}},F=U,V=(n("7c54"),n("cb32")),R=n("6ac0"),H=n("9c40"),K=n("4e73"),W=n("1c1c"),X=n("66e5"),Y=n("4074"),Z=n("eb85"),tt=n("b498"),et=Object(v["a"])(F,o,i,!1,null,"5c1f2dde",null);e["a"]=et.exports;B()(et,"components",{QAvatar:V["a"],QVideo:R["a"],QBtn:H["a"],QMenu:K["a"],QList:W["a"],QItem:X["a"],QItemSection:Y["a"],QSeparator:Z["a"],QColor:tt["a"]})},bea7:function(t,e,n){"use strict";var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("q-btn",{directives:[{name:"require-login-click",rawName:"v-require-login-click"}],staticClass:"btn",attrs:{outline:"",color:"primary"},on:{click:t.showAddArtrcle}},[n("svg",{class:"svg-icon svg-icon--primary mr5",attrs:{width:"16",height:"16",viewBox:"0 0 16 16",xmlns:"http://www.w3.org/2000/svg","svg-inline":"",role:"presentation",focusable:"false",tabindex:"-1"}},[n("path",{attrs:{d:"M9.29 3.041l3.667 3.668-9.287 9.288h-.002V16H.001v-3.668H0l9.29-9.29zm1.037-1.037L12.33 0 16 3.666l-2.006 2.006-3.667-3.668z",fill:"#2A3542","fill-rule":"nonzero"}})]),n("span",[t._v("发言")]),n("Dialog",{attrs:{groupId:t.groupId,onSave:t.onSave},model:{value:t.shouldShowDialog,callback:function(e){t.shouldShowDialog=e},expression:"shouldShowDialog"}}),n("JoinGroup",{attrs:{groupId:t.groupId},on:{wantJoin:t.wantJoin},model:{value:t.showJoinGroup,callback:function(e){t.showJoinGroup=e},expression:"showJoinGroup"}})],1)},i=[],a=(n("c5f6"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("Publish",t._b({attrs:{placeholder:"有什么新鲜事告诉大家…",publishBtnLabel:"快速发帖",initialData:t.draft,shouldResetAfterClose:!1,doPublish:t.publish,onEdit:t.onEdit,maxTextLength:5e3},model:{value:t.shouldShow,callback:function(e){t.shouldShow=e},expression:"shouldShow"}},"Publish",t.$attrs,!1))}),r=[],s=(n("8e6e"),n("8a81"),n("ac6a"),n("cadf"),n("06db"),n("456d"),n("c47a")),c=n.n(s),l=n("c2ac"),u=n("97af"),d=function(){try{var t=window["localStorage"],e="__storage_test__";return t.setItem(e,e),t.removeItem(e),!0}catch(n){return!1}};function p(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function h(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?p(Object(n),!0).forEach((function(e){c()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var f=function(t){var e="/protected/post/create";return Object(u["b"])(e,h({},t,{title:""})).then((function(t){return t.post}))},m=function(){return d()?{content:localStorage.getItem("draft_createArticle")||"",images:[]}:{content:"",images:[]}},v=function(t){d()&&localStorage.setItem("draft_createArticle",t)},g={components:{Publish:l["a"]},props:{groupId:{type:Number,required:!0},onSave:{type:Function},value:Boolean},data:function(){return{draft:m()}},computed:{shouldShow:{get:function(){return this.value},set:function(t){this.$emit("input",t)}}},methods:{onEdit:function(t){v(t.content)},publish:function(t){var e=this;return f(h({},t,{grp:this.groupId})).then((function(t){e.onSave&&e.onSave(t)}))}}},b=g,w=n("2877"),y=Object(w["a"])(b,a,r,!1,null,null,null),_=y.exports,k=n("fa0e"),x={components:{Dialog:_,JoinGroup:k["a"]},props:{groupId:{type:Number,required:!0},onSave:{type:Function}},computed:{groupJoined:function(){return this.$store.getters["group/ifCurrentGroupJoined"]}},data:function(){return{shouldShowDialog:!1,showJoinGroup:!1}},methods:{showAddArtrcle:function(){this.groupJoined?this.shouldShowDialog=!0:this.showJoinGroup=!0},wantJoin:function(){this.$emit("wantJoin")}}},q=x,C=(n("af08"),n("eebe")),S=n.n(C),$=n("9c40"),O=Object(w["a"])(q,o,i,!1,null,"4bba5f60",null);e["a"]=O.exports;S()(O,"components",{QBtn:$["a"]})},c2ac:function(t,e,n){"use strict";var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("q-dialog",{attrs:{persistent:t.isLoading},model:{value:t.shouldShow,callback:function(e){t.shouldShow=e},expression:"shouldShow"}},[n("div",{staticClass:"container"},[t.isLoading?n("div",{staticClass:"waiting"},[n("q-spinner",{attrs:{color:"primary",size:"3em"}})],1):t._e(),n("div",{staticClass:"header"},[n("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],staticClass:"closeIcon header_left",attrs:{icon:"close",flat:"",round:"",dense:""}})],1),t._t("default"),n("div",{ref:"body",staticClass:"body"},[n("img",{staticClass:"avatar",attrs:{src:t.curUserAvatar}}),n("q-input",{staticClass:"textarea",attrs:{borderless:"",autogrow:"",placeholder:t.placeholder,maxlength:t.maxTextLength},model:{value:t.content,callback:function(e){t.content=e},expression:"content"}})],1),n("div",{staticClass:"media grid",attrs:{"data-length":t.mediaLength}},[t._l(t.imgList,(function(e){return n("div",{key:e.id,staticClass:"grid_item imgItem",style:{backgroundImage:"url("+e.previewUrl+")"}},[n("div",{staticClass:"close removeBtn",on:{click:function(n){return t.removeMedia("imgList",e.id)}}},[n("q-icon",{attrs:{name:t.removeIcon}})],1)])})),t._l(t.videoList,(function(e){return n("div",{key:e.id,staticClass:"grid_item videoItem"},[n("q-media-player",{attrs:{type:"video","background-color":"black",radius:"4px","hide-volume-slider":"",dense:"","show-big-play-button":!1,sources:[{src:e.previewUrl}]}}),n("div",{staticClass:"close removeBtn",on:{click:function(n){return t.removeMedia("videoList",e.id)}}},[n("q-icon",{attrs:{name:t.removeIcon}})],1)],1)}))],2),n("div",{staticClass:"footer"},[n("div",{staticClass:"footer_left"},[n("svg",{class:"imgBtn svg-icon svg-icon--middle-grey svg-icon--hover-dark-grey",attrs:{width:"24",height:"21",viewBox:"0 0 24 21",xmlns:"http://www.w3.org/2000/svg","svg-inline":"","data-disabled":!t.canUploadImg,role:"presentation",focusable:"false",tabindex:"-1"},on:{click:t.onImgBtnClick}},[n("path",{attrs:{d:"M20.413 20.125H3.163A3.166 3.166 0 010 16.963v-13.8A3.166 3.166 0 013.163 0h17.25a3.166 3.166 0 013.162 3.163v13.8a3.166 3.166 0 01-3.162 3.162zm-17.25-18.4c-.793 0-1.438.645-1.438 1.438v13.8c0 .793.645 1.437 1.438 1.437h17.25c.793 0 1.437-.644 1.437-1.437v-13.8c0-.793-.644-1.438-1.437-1.438H3.163zm7.615 14.825a.86.86 0 01-.61-.253l-2.84-2.84-2.624 2.625a.862.862 0 11-1.22-1.22l3.234-3.234a.888.888 0 011.22 0l3.45 3.45a.862.862 0 01-.61 1.472zm8.655-.953a.86.86 0 01-.61-.253l-4.88-4.88-2.238 2.237a.862.862 0 11-1.22-1.22l2.847-2.847a.862.862 0 011.22 0l5.49 5.49a.862.862 0 01-.61 1.473zM8.855 10.326a3.167 3.167 0 01-3.162-3.163A3.166 3.166 0 018.855 4a3.166 3.166 0 013.163 3.163 3.167 3.167 0 01-3.163 3.163zm0-4.6c-.793 0-1.437.644-1.437 1.437s.645 1.438 1.437 1.438a1.439 1.439 0 000-2.875z",fill:"#8C909D","fill-rule":"nonzero"}})]),n("svg",{class:"imgBtn svg-icon svg-icon--middle-grey svg-icon--hover-dark-grey",attrs:{width:"25",height:"21",viewBox:"0 0 25 21",xmlns:"http://www.w3.org/2000/svg","svg-inline":"","data-disabled":!t.canUploadVideo,role:"presentation",focusable:"false",tabindex:"-1"},on:{click:t.onVideoBtnClick}},[n("g",{attrs:{fill:"none","fill-rule":"evenodd"}},[n("path",{attrs:{d:"M21.162 20.125H3.912a3.166 3.166 0 01-3.163-3.162v-13.8A3.166 3.166 0 013.912 0h17.25a3.166 3.166 0 013.163 3.163v13.8a3.166 3.166 0 01-3.163 3.162zm-17.25-18.4c-.793 0-1.438.645-1.438 1.438v13.8c0 .793.645 1.437 1.438 1.437h17.25c.793 0 1.437-.644 1.437-1.437v-13.8c0-.793-.644-1.438-1.437-1.438H3.912z",fill:"#8C909D","fill-rule":"nonzero"}}),n("path",{attrs:{d:"M13.927 10.154l-2.908-1.696v3.392l2.908-1.696z",stroke:"#8C909D","stroke-width":"3"}})])])]),n("div",{staticClass:"footer_right"},[n("div",{staticClass:"wordLength"},[t._v(t._s(t.content.length)+"/"+t._s(t.maxTextLength))]),n("q-btn",{staticClass:"sendPostBtn",attrs:{unelevated:"",disabled:!t.canPublish,color:"primary"},on:{click:t.publish}},[n("svg",{class:"svg-icon svg-icon--white",attrs:{width:"14",height:"14",viewBox:"0 0 14 14",xmlns:"http://www.w3.org/2000/svg","svg-inline":"",role:"presentation",focusable:"false",tabindex:"-1"}},[n("path",{attrs:{d:"M0 7.612l4.348 1.863 7.011-6.233-5.133 6.265 5.655 1.845L14 0 0 7.612zM6.226 14l2.459-2.349-2.459-.813V14z",fill:"#FFF","fill-rule":"nonzero"}})]),n("span",[t._v(t._s(t.publishBtnLabel))])])],1)]),n("input",{ref:"imgInput",attrs:{hidden:"hidden",id:"file-chooser",type:"file",accept:"image/*",multiple:""},on:{change:t.uploadImg}}),n("input",{ref:"videoInput",attrs:{hidden:"hidden",id:"vadio-chooser",type:"file",accept:"video/*"},on:{change:t.uploadVideo}})],2)])},i=[],a=(n("8e6e"),n("8a81"),n("456d"),n("967e")),r=n.n(a),s=(n("551c"),n("ac6a"),n("cadf"),n("06db"),n("5df3"),n("96cf"),n("fa84")),c=n.n(s),l=(n("4917"),n("c47a")),u=n.n(l),d=n("118e"),p=n.n(d),h=n("4db1"),f=n.n(h),m=(n("f751"),n("c5f6"),n("6dcb")),v=n("06ae"),g=function(){var t=c()(r.a.mark((function t(e){return r.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e;case 3:return t.abrupt("return",t.sent);case 6:return t.prev=6,t.t0=t["catch"](0),t.abrupt("return",t.t0);case 9:case"end":return t.stop()}}),t,null,[[0,6]])})));return function(e){return t.apply(this,arguments)}}(),b=g,w=n("d272");function y(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function _(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?y(Object(n),!0).forEach((function(e){u()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):y(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var k={created:function(){this.removeIcon=v["a"],this.sendIcon=w["a"]},props:{maxTextLength:{type:Number,default:2e3},placeholder:{type:String},publishBtnLabel:{type:String},initialData:{type:Object,default:function(){return{content:"",images:[]}}},doPublish:{type:Function,required:!0},onEdit:{type:Function},shouldResetAfterClose:{type:Boolean,default:!0},value:Boolean},data:function(){return this.getDefaultData()},watch:{shouldShow:function(t){!t&&this.shouldResetAfterClose&&Object.assign(this,this.getDefaultData())},content:function(){this.onChange()},videoList:function(){this.onChange()},imgList:function(){this.onChange()}},computed:{shouldShow:{get:function(){return this.value},set:function(t){this.$emit("input",t)}},canPublish:function(){var t=this.content.trim().length;return t>0&&t<=this.maxTextLength},curUserAvatar:function(){return this.$store.state.user.avatar||"statics/user.svg"},mediaLength:function(){return this.videoList.length>0?this.videoList.length:this.imgList.length},canUploadImg:function(){return 0===this.videoList.length&&4!==this.imgList.length},canUploadVideo:function(){return 0===this.videoList.length&&0===this.imgList.length}},methods:{onChange:function(){if(this.onEdit){var t={images:[].concat(f()(this.imgList),f()(this.videoList)),content:this.content};this.onEdit(t)}},getDefaultData:function(){var t=this.initialData,e=t.images,n=p()(t,["images"]),o=_({isLoading:!1,videoList:[],imgList:[],content:""},n);if(!e||0===e.length)return o;var i=e.map((function(t){return{file:null,previewUrl:t,id:t}}));return e[0].match(/\.(png|jpe?g|gif)/i)?_({},o,{imgList:i}):_({},o,{videoList:i})},removeMedia:function(t,e){this[t]=this[t].filter((function(t){return t.id!==e}))},warnTooManyFiles:function(){return this.$q.notify("只能上传四张图片，或一个视频")},onImgBtnClick:function(){if(4===this.imgList.length||1===this.videoList.length)return this.warnTooManyFiles();this.$refs.imgInput.click()},onVideoBtnClick:function(){if(this.imgList.length>0||1===this.videoList.length)return this.warnTooManyFiles();this.$refs.videoInput.click()},uploadImg:function(t){var e=t.target.files;if(0!==e.length){if(this.imgList.length+e.length>4)return this.warnTooManyFiles();var n=[].map.call(e,(function(t,e){return{file:t,id:Date.now()+e,previewUrl:window.URL.createObjectURL(t)}}));this.imgList=this.imgList.concat(n),t.target.value=""}},uploadVideo:function(t){var e=t.target.files[0];if(e){if(e.size/1e6>500)return t.target.value="",this.$q.notify("文件大小不能超过 500M");this.videoList.push({file:e,id:Date.now(),previewUrl:window.URL.createObjectURL(e)}),t.target.value=""}},publish:function(){var t=c()(r.a.mark((function t(){var e,n,o=this;return r.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(0!==this.content.trim().length){t.next=2;break}return t.abrupt("return",this.$q.notify("请输入内容"));case 2:return this.isLoading=!0,t.next=5,b(Promise.all([].concat(f()(this.imgList),f()(this.videoList)).map((function(t){var e=t.file,n=t.previewUrl;return null===e?Promise.resolve(n):Object(m["a"])({file:e,dispositionType:"attachment"})}))));case 5:if(e=t.sent,!(e instanceof Error)){t.next=10;break}return this.isLoading=!1,this.$q.notify("发布失败,"+e),t.abrupt("return");case 10:n={content:this.content,images:e},this.doPublish(n).then((function(){Object.assign(o,o.getDefaultData(),{shouldShow:!1}),o.$q.notify("发布成功")})).catch((function(t){o.isLoading=!1;var e="string"===typeof t?t:t.message;o.$q.notify("发布失败,"+e)}));case 12:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()}},x=k,q=(n("c7c8"),n("2877")),C=n("eebe"),S=n.n(C),$=n("24e8"),O=n("0d59"),I=n("9c40"),P=n("27f9"),j=n("0016"),L=n("7f67"),E=Object(q["a"])(x,o,i,!1,null,"133e0b48",null);e["a"]=E.exports;S()(E,"components",{QDialog:$["a"],QSpinner:O["a"],QBtn:I["a"],QInput:P["a"],QIcon:j["a"]}),S()(E,"directives",{ClosePopup:L["a"]})},c7c8:function(t,e,n){"use strict";var o=n("530c"),i=n.n(o);i.a},c7eb:function(t,e,n){},cb70:function(t,e,n){"use strict";var o=n("2ba9"),i=n.n(o);i.a},cbd7:function(t,e,n){"use strict";var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("q-btn",{directives:[{name:"require-login-click",rawName:"v-require-login-click"}],attrs:{unelevated:"",disabled:t.isJoined,color:"primary",label:t.label,icon:"add"},on:{click:t.onClick}}),n("JoinGroupNeedPay",{on:{wantjoin:t.checkPass},model:{value:t.showJoinGroupNeedPay,callback:function(e){t.showJoinGroupNeedPay=e},expression:"showJoinGroupNeedPay"}})],1)},i=[],a=(n("551c"),n("06db"),n("097d"),n("c5f6"),n("97af")),r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("ToastComponent",{attrs:{title:t.title,content:t.content},on:{taost_cancel:t.taost_cancel,taost_confirm:t.taost_confirm},model:{value:t.shouldShow,callback:function(e){t.shouldShow=e},expression:"shouldShow"}})},s=[],c=n("27cf"),l={components:{ToastComponent:c["a"]},props:{value:Boolean,groupId:Number},data:function(){return{title:"入群将从你的钱包扣费",content:"",reward:""}},watch:{},computed:{shouldShow:{get:function(){return this.value},set:function(t){this.$emit("input",t)}}},methods:{taost_cancel:function(){this.$q.notify("已取消")},taost_confirm:function(){this.$emit("wantjoin")}},created:function(){},mounted:function(){}},u=l,d=n("2877"),p=Object(d["a"])(u,r,s,!1,null,null,null),h=p.exports,f=function(t,e){return Object(a["b"])("/protected/grp/join",{grp:t,password:e})},m={props:{groupInfo:{type:Object,required:!0},onJoined:{type:Function}},components:{JoinGroupNeedPay:h},computed:{label:function(){return this.isJoined?"已加入":"加入小组"}},data:function(){return{isJoined:!1,showJoinGroupNeedPay:!1}},methods:{onClick:function(){Number(this.groupInfo.reward_join)<0?this.showJoinGroupNeedPay=!0:this.checkPass()},checkPass:function(){var t=""!==this.groupInfo.password;if(t)return this.requestPassword();this.joinGroup()},requestPassword:function(){this.$q.dialog({title:"加密群组",message:"请输入群组密码",prompt:{model:"",type:"text"},cancel:!0}).onOk(this.joinGroup)},joinGroup:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.$q.loading.show(),f(this.groupInfo.id,e).then((function(){t.isJoined=!0,t.$q.notify({message:"加入成功！"}),t.$router.go(0)})).catch((function(e){var n=function(){return 100===e.code?"加入群失败！密码错误":104===e.code?"加入群失败！请重新登录":e.message}();t.$q.notify({message:n})})).finally((function(){t.$q.loading.hide()}))}}},v=m,g=n("eebe"),b=n.n(g),w=n("9c40"),y=Object(d["a"])(v,o,i,!1,null,null,null);e["a"]=y.exports;b()(y,"components",{QBtn:w["a"]})},d443:function(t,e,n){"use strict";var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("input",{ref:"imgInput",attrs:{hidden:"hidden",type:"file",accept:"image/*"},on:{change:t.uploadImg}})},i=[],a=(n("7f7f"),n("967e")),r=n.n(a),s=(n("96cf"),n("fa84")),c=n.n(s),l=n("6dcb"),u={components:{},props:{},data:function(){return{}},watch:{},computed:{},methods:{upload:function(){this.$refs.imgInput.click()},uploadImg:function(t){var e=this;return c()(r.a.mark((function n(){var o,i;return r.a.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(o=t.target.files[0],o){n.next=3;break}return n.abrupt("return");case 3:if(!(o.size/1e6>5)){n.next=6;break}return t.target.value="",n.abrupt("return",e.$q.notify("头像大小不能超过 5M"));case 6:return e.$emit("uploading"),n.next=9,Object(l["a"])({file:o});case 9:i=n.sent,i instanceof Error?(e.$q.notify("头像上传失败，"+i),e.$emit("uploaded",{err:i})):e.$emit("uploaded",{url:i}),t.target.value="";case 12:case"end":return n.stop()}}),n)})))()},updateUserAvatar:function(t){var e=this;return c()(r.a.mark((function n(){var o,i,a;return r.a.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return o="/protected/user/modify",i={name:e.$store.state.user.name,avatar:t},n.next=4,e.$axios.put(o,i);case 4:a=n.sent,0===a.data.code?e.$q.notify("头像修改成功"):e.$q.notify("头像修改失败");case 6:case"end":return n.stop()}}),n)})))()}},created:function(){},mounted:function(){}},d=u,p=n("2877"),h=Object(p["a"])(d,o,i,!1,null,null,null);e["a"]=h.exports},de22:function(t,e,n){"use strict";var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"main"},[n("router-link",{attrs:{to:{path:"/"}}},[n("q-btn",{staticClass:"mainpage-btn",attrs:{flat:"",dense:""}},[t._v("DAO")])],1)],1)},i=[],a={name:"headerBarLeft",props:{},data:function(){return{showCreate:!1}},watch:{},computed:{},methods:{createGrp:function(){this.showCreate=!0},clearLogin:function(){localStorage.removeItem("token"),localStorage.removeItem("userinfo"),localStorage.removeItem("notifications"),this.$router.go(0)}},created:function(){},mounted:function(){}},r=a,s=(n("e73d"),n("2877")),c=n("eebe"),l=n.n(c),u=n("4e73"),d=n("1c1c"),p=n("66e5"),h=n("4074"),f=n("eb85"),m=n("9c40"),v=Object(s["a"])(r,o,i,!1,null,"5ba94014",null);e["a"]=v.exports;l()(v,"components",{QMenu:u["a"],QList:d["a"],QItem:p["a"],QItemSection:h["a"],QSeparator:f["a"],QBtn:m["a"]})},e019:function(t,e,n){"use strict";var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("Publish",t._b({attrs:{publishBtnLabel:"发布",placeholder:"发布你的回复",doPublish:t.publish},model:{value:t.shouldShow,callback:function(e){t.shouldShow=e},expression:"shouldShow"}},"Publish",t.$attrs,!1),[n("div",{staticClass:"container"},[n("img",{staticClass:"avatar",attrs:{src:t.targetPost.creator.avatar||"statics/user.svg"}}),n("div",{staticClass:"right"},[n("div",{staticClass:"meta"},[n("span",{staticClass:"name"},[t._v(t._s(t.targetPost.creator.name))]),n("span",{staticClass:"time"},[t._v(t._s(t.$utils.timeStringToLocal(t.targetPost.post.create_at,"RelativeTime")))])]),n("div",{staticClass:"content"},[t._v(t._s(t.targetPost.post.content))])])])])},i=[],a=(n("8e6e"),n("8a81"),n("ac6a"),n("cadf"),n("06db"),n("456d"),n("c47a")),r=n.n(a),s=n("c2ac"),c=n("97af");function l(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function u(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?l(Object(n),!0).forEach((function(e){r()(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var d=function(t){return Object(c["b"])("/protected/comment/create",u({},t,{ref_comment:null})).then((function(t){return t.comment}))},p={components:{Publish:s["a"]},props:{targetPost:{type:Object,required:!0},onSave:{type:Function},value:Boolean},computed:{shouldShow:{get:function(){return this.value},set:function(t){this.$emit("input",t)}}},methods:{publish:function(t){var e=this;return d(u({},t,{post:this.targetPost.post.id})).then((function(t){e.onSave&&e.onSave(t)}))}}},h=p,f=(n("78e0"),n("2877")),m=Object(f["a"])(h,o,i,!1,null,"42e4b5b4",null);e["a"]=m.exports},e73d:function(t,e,n){"use strict";var o=n("c7eb"),i=n.n(o);i.a},eeee:function(t,e,n){"use strict";var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"fit row"},t._l(t.members,(function(e){return n("div",{key:e.id,staticClass:"main"},[n("div",[t.edit?n("q-avatar",{attrs:{size:t.size}},[n("img",{attrs:{src:e.avatar||"statics/user.svg"}}),n("q-badge",{staticClass:"cursor-pointer",attrs:{color:"red",floating:""},on:{click:function(n){return n.stopPropagation(),t.setMember(e.id)}}},[t._v("x")])],1):n("router-link",{attrs:{to:{name:"person",params:{id:e.id+""}}}},[n("q-avatar",{staticClass:"hoverable-avatar",attrs:{size:t.size}},[n("img",{attrs:{src:e.avatar||"statics/user.svg"}})])],1)],1),n("div",{staticClass:"cursor-pointer name",on:{click:function(n){return t.jumpToMember(e.id)}}},[t._v(t._s(e.name))])])})),0)},i=[],a=n("967e"),r=n.n(a),s=(n("96cf"),n("fa84")),c=n.n(s),l={props:{members:Array,edit:{type:Boolean,default:!1},blocked:{type:Boolean,default:!1},mainpage:{type:Boolean,default:!1},size:{type:String,default:"55px"}},data:function(){return{showBlock:!1,clickedMemberId:0}},methods:{jumpToMember:function(t){this.$router.push("/person/show/"+t)},setMember:function(t){this.showBlock=!0,this.blockMember(t)},blockMember:function(t){var e=this;return c()(r.a.mark((function n(){var o,i,a;return r.a.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return o="/protected/grp/block",i={grp:e.$store.state.group.currentGroup.id,user:t,block:e.blocked?1:2},n.next=4,e.$axios.post(o,i);case 4:a=n.sent,0===a.data.code?(e.$q.notify({message:e.blocked?"已解除拉黑":"已拉黑该用户"}),e.$emit("changeBlockStatus",{userId:t,type:e.blocked?"unblock":"block"})):104===a.data.code&&(e.$q.notify({message:"认证失效，请重新登录"}),e.$showLogin());case 6:case"end":return n.stop()}}),n)})))()}}},u=l,d=(n("cb70"),n("2877")),p=n("eebe"),h=n.n(p),f=n("cb32"),m=n("58a8"),v=Object(d["a"])(u,o,i,!1,null,"3f56e4c9",null);e["a"]=v.exports;h()(v,"components",{QAvatar:f["a"],QBadge:m["a"]})},f5da:function(t,e,n){},f8c8:function(t,e,n){"use strict";n.d(e,"a",(function(){return a})),n.d(e,"b",(function(){return r}));n("551c"),n("06db");var o=n("758b"),i=function(t){return function(e,n){return new Promise((function(i,a){o["a"][t](e,n).then((function(t){0===t.data.code?i(t.data):a(t.data.message)})).catch((function(t){a(t)}))}))}},a=i("get"),r=i("post");i("put"),i("delete")},fa0e:function(t,e,n){"use strict";var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("ToastComponent",{attrs:{title:t.title,content:t.content},on:{taost_cancel:t.taost_cancel,taost_confirm:t.taost_confirm},model:{value:t.shouldShow,callback:function(e){t.shouldShow=e},expression:"shouldShow"}})},i=[],a=(n("c5f6"),n("27cf")),r={components:{ToastComponent:a["a"]},props:{value:Boolean,groupId:Number},data:function(){return{title:"发言需要先加入群组",content:"是否现在加入？",reward:""}},watch:{},computed:{shouldShow:{get:function(){return this.value},set:function(t){this.$emit("input",t)}}},methods:{taost_cancel:function(){this.$q.notify("已取消")},taost_confirm:function(){this.$emit("wantJoin")}},created:function(){},mounted:function(){}},s=r,c=n("2877"),l=Object(c["a"])(s,o,i,!1,null,null,null);e["a"]=l.exports},fa79:function(t,e,n){}}]);